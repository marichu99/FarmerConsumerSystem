<!DOCTYPE html>
<html>
    <head lang="en">
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- CSS -->
    <link rel="stylesheet" href="dash.css">
    <link rel="stylesheet" href="checkout.css">

    <title>Customer Dashboard Panel</title>
    </head>
    <body>
        <div class="navlets">

            <!-- the div below is for the Sidebar Container -->

            <nav class="navContainer">
                <div class="logoName">
                    <span class="logo_name">Ukulima Bora</span>
                </div>
                <form method="post">
                <div class="menu-items">
                    <ul class="nav-links">
                        <li><a href="#">
                        <img src="icons/home.jpg" class="icon"/>
                            <span class="link-name" onclick="window.location.href='customerDash.php'">Dashboard</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/chart-line.jpg" class="icon"/>
                            <span class="link-name" onclick="showPage('approvals')">Approval Status</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/adjust-circle.jpg" class="icon" />
                            <span class="link-name" onclick="showPage('profile')" >My Account</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/user-circle.jpg"class="icon"/>
                            <span class="link-name" onclick="showPage('produce')">My Products</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/angle-double-down.jpg"class="icon"/>
                            <span class="link-name" onclick="window.location.href='sell.php'">Sell</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/angle-double-up.jpg"class="icon"/>
                            <span class="link-name" onclick="window.location.href='buy.php'">Buy</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/plane-fly.jpg"class="icon" />
                            <span class="link-name" onclick="showPage('reports')">Reports</span>
                        </a></li>
                        <li><a href="#">
                        <img src="icons/plane-arrival.jpg" class="icon" />
                            <span class="link-name" onclick="showPage('PurchaseApprovals')">Purchase Approval</span>
                        </a></li>
                        
                        
                    </ul>

                    <ul>
                        <li><a href="logout.php">
                        <img src="icons/signout.jpg" class="icon" />
                            <span class="link-name">Log out</span>
                        </a></li>
                    </ul>
                </div>
                </form>
            </nav>

            
            <!-- the div below is for the main content -->

            <div class="dashboard">
                <!-- div for the top level stuff -->
                <div class ="top">
                    <div class="search-box">
                    <img src="icons/user-circle.jpg"class="icon"/>
                    <span></span>
                    </div>
                </div>
                <!-- div for the header content -->
                
                <!-- div for sign up to users -->

                <!-- div for users -->
                <section class="farm_produce" id="allUsers">        
                    <h3 id="userHead">Featured Farm Products</h3>
                    
                    <div class="prod_row" id="users">
                        <div class="main" id="main"> 
                        <form action="profileUpload.php" enctype="multipart/form-data" method="POST" >
                                <div class="row">
                                    <div class="col">
                                        <h3 class="title" onclick="window.location.href='productDetail.php'">Please Provide us with more details</h3>
                                        <div class="profileHeader">
                                            <div class="userDetails">
                                                <h2></h2>
                                                <p></p>
                                                
                                            </div>
                                            <div class="userImage">
                                                <!-- check whether the user has uploaded the photos -->

                                                ?>
                                                <div class="profilePic">
                                                    <img src="images/ <?php echo $rows["userIMG"];?>" alt="" id="pic">
                                                </div>

                                                <?php } else{  ?>
                                                <!-- else -->
                                                <div class="profilePic">
                                                    <img src="images/profile.jpg" alt="" id="pic">
                                                </div>
                                                <input type="file" id="upload" accept="Image/*" onchange="readURL(this)" value="Select an Image" name="userIMG"/>
                                                <?php 
                                                }
                                                ?>
                                                
                                            </div>
                                        </div>
                                        <div class="details">
                                            <div>
                                                <div class="user">
                                                    <label>Change your Password</label>
                                                    <input type="password" placeholder="Enter your password" name="password" id="password"/>
                                                </div>
                                                <div class="user">
                                                    <label>Confirm your Password</label>
                                                    <input type="password" placeholder="Confirm your Password" name="passwordRe" id="passwordRE"/>
                                                </div>
                                                
                                                <div class="flex">
                                                    <div class="user">
                                                    <input type="submit" value="SUBMIT CHANGES" class="submit" name="submit">
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="user">
                                                    <label id="passError"></label>
                                                </div>
                                                <div class="user">
                                                    <label id="passConfirm"></label>
                                                </div>
                                                <div class="flex">
                                                    <div class="user">
                                                    <input type="submit" value="DELETE ACCOUNT" class="submit" name="delete" id="delete">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                      </div>
                                            
                                </div>
        
                        </form>
                        </div>
                    </div>
                
                </section>    
                <!-- div for products -->
                <section class="farm_produce" id="farms">        
                    <h3>Featured Farm Products</h3>
                    <?php if($all==true){
                        echo "All produce";
                    }else{
                        echo $numResult." results found";
                    }?>
                    <div class="prod_row" id="farm_produces">
                        <!-- all products -->
                        
                   
                        
                        <div class="prod_item">                            
                            <img src='prodIMG/' class="image_prod"/><br/>
                            <span class="prodName"></span><br/>
                            <span class="prodLocation"></span><br/>
                            <span class="prodPrice"></span><br/>
                        </div>
                                  
                        
                        ?>
                </div>
                
            </section>         
                <!-- div for approvals -->
                <section class="farm_produce" id="approvalSect">                                            
                        <div class="prod_row" id="usersApproval">
                            <div class="main" id="main"> 
                                <form>

                                    <div class="row">
                                        <div class="col">
                                            <h3 class="title" onclick="window.location.href='productDetail.php'"> YOUR APPROVAL STATUS IS: </h3>

                                            <div class="detailsApproved">
                                                <h3 class="mode"><img src="icons/check.svg" class="icons" id="checked" />Approved</h3>
                                            </div>
                                            <div class="detailsApproved">
                                                <span>Dear @ </span><br/>
                                                <p>Your details have been approved and you can <a href="sell.php">sell</a> on the platform.</p>
                                            </div>
                                            
                                            <div class="detailsApproved">
                                                <h3 class="modeNot"><img src="icons/times.svg" class="icons" id="checked" /></i>REJECTED</h3>
                                            </div>
                                            <div class="detailsApproved">
                                                <span>Dear @ </span><br/>
                                                <p>Your request for seller approval has been rejected by the admin. If you wish to appeal kindly reach out to them @ ukulimabora44@gmail.com</p>
                                            </div>
                                            
                                            <p>You can request for a seller's approval at the <a href="sell.php">sell</a> on the platform.</p>
                                        </div>                                                

                                    </div>      
                                </form>      
                            </div>
                        </div>                
                
                </section>
                <!-- div for ?PurchaseApprovals? -->
                <section class="farm_produce" id="approvalSect">        
                <h3 id="userHead">Request for Sell Approval</h3>                    
                    <div class="prod_row" id="PurchaseApprovals">                  
                      <!-- all products -->
            
                        
                        <div class="prod_item">
                            <span></span>
                            <img src='prodIMG/<?php echo $arr_results[$iterations]["productImg"];?>' class="image_prod"/><br/>
                            <span class="prodName">Buyer Name: <?php echo $arr_results[$iterations]["buyer"]; ?></span><br/>
                            
                                <?php 
                                    $farmername=$arr_results[$iterations]['buyer'];
                                    $productID=$arr_results[$iterations]['productID'];
                                    $purchaseID=$arr_results[$iterations]["purchaseID"];                                    
                                ?>
                            <div className="fpRating">
                                <button class="approveUser" onclick="window.location.href='approve.php?approve=Yes&buyer=<?php echo $farmername;?>&productID=<?php echo $productID?>&purchaseID=<?php echo $purchaseID?>'">APPROVE SALE</a></button>
                                <button class="rejectUser" onclick="window.location.href='approve.php?approve=No&buyer=<?php echo $farmername;?>&productID=<?php echo $productID?>&purchaseID=<?php echo $purchaseID?>'">REJECT SALE</a></button><BR/>
                            </div>
                        </div>
                        <?php
                            $iterations=$iterations+1;
                                }
                            }
                        }                     
                        
                        ?>
                    </div>
                
                </section>
                    
                    <?php 

                            if(isset($_SESSION["Username"])){
                                // $buttonclicked="None";
                            if($buttonclicked == "None"){
                                echo "
                                    <script type='text/javascript'>
                                    var admin=document.querySelector('.farm_produce');
                                    var farms=document.getElementById('farms');
                                    var approvalSect=document.getElementById('approvalSect');
                                    var produce=document.getElementById('farm_produces');
                                    farms.style.display='none';
                                    produce.style.display='none';
                                    admin.style.display='none';
                                    approvalSect.style.display='none';
                                    </script>            
                                    ";
                                include("customerDashMain.php ");
                            }else if($buttonclicked == "admin"){
                                // echo $buttonclicked;
                                echo "
                                    <script type='text/javascript'>
                                    var admin=document.getElementById('main');
                                    admin.style.display='flex';
                                    </script>            
                                    ";
                            }else if($buttonclicked == "profile"){
                                // echo $buttonclicked;
                                echo "
                                    <script type='text/javascript'>
                                    var users=document.getElementById('users');
                                    var heading=document.getElementById('userHead');
                                    var main=document.getElementById('main');
                                    var farms=document.getElementById('farms');
                                    var approvals=document.getElementById('approvalSect');
                                    approvals.style.display='none';
                                    main.style.display='flex';
                                    heading.textContent='User List';
                                    users.style.display='flex';
                                    farms.style.display='none';
                                    </script>            
                                    ";
                            }else if($buttonclicked == "produce"){
                                // echo $buttonclicked;
                                echo "
                                    <script type='text/javascript'>
                                    var produce=document.getElementById('farm_produces');
                                    var heading=document.getElementById('userHead');
                                    var farm_produce=document.getElementById('allUsers');
                                    var approvals=document.getElementById('approvalSect');
                                    approvals.style.display='none';
                                    farm_produce.style.display='none';
                                    heading.textContent='';
                                    produce.style.display='flex';
                                    </script>            
                                    ";
                            }else if($buttonclicked == "approvals"){
                                // echo $buttonclicked;
                                echo "
                                    <script type='text/javascript'>
                                    var approvals=document.getElementById('usersApproval');
                                    var heading=document.getElementById('userHead');
                                    var farm_produce=document.getElementById('allUsers');
                                    var farms =document.getElementById('farms');
                                    farms.style.display='none';
                                    farm_produce.style.display='none';
                                    heading.textContent='';
                                    approvals.style.display='flex';
                                    </script>            
                                    ";
                            }else if($buttonclicked == "reports"){
                                echo "
                                    <script type='text/javascript'>
                                    var farms =document.getElementById('farms');
                                    farms.style.display='none';
                                    var userHead=document.getElementById('userHead');
                                    userHead.textContent='Customized User Reports';
                                    var approvalSect = document.getElementById('approvalSect');
                                    approvalSect.style.display='none';
                                    </script>            
                                    ";
                                include("reports.php");
                            }
                            else if($buttonclicked == "PurchaseApprovals"){
                                echo "
                                <script type='text/javascript'>
                                var approvals=document.getElementById('PurchaseApprovals');
                                var heading=document.getElementById('userHead');
                                var farm_produce=document.getElementById('allUsers');
                                var farms =document.getElementById('farms');
                                farms.style.display='none';
                                farm_produce.style.display='none';
                                heading.textContent='';
                                approvals.style.display='flex';
                                </script>            
                                ";
                            }
                                
                            }
                        ?>
             </div>
        </div>
        
        <script type="text/javascript">
            // get the div elements
           
            function showPage(type) {      
                if(type === "approvals"){
                    window.location.href='customerDash.php?mode=approvals';                
                }else if(type === "profile"){
                    window.location.href='customerDash.php?mode=profile';
                }else if(type === "produce"){
                    window.location.href='customerDash.php?mode=produce';
                }else if(type === "reports"){
                    window.location.href='customerDash.php?mode=reports';
                }else if(type === "PurchaseApprovals"){
                    window.location.href='customerDash.php?mode=PurchaseApprovals';
                }
                
            }
            function rejectApprove(type,person){
                console.log(type,person)
                
            }
            function toggleSidebar(){
                console.log(window.innerWidth);
                // this funtion will only work on smaller devices using the code below
                if(window.innerWidth <=600){
                    // get the sidebar class id
                    var sidebar=document.querySelector(".navContainer");
                    sidebar.style.display="none";
                }
1            }
           
        </script>
    </body>
</html>